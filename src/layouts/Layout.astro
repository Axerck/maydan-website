---
import '../styles/custom.css';
import { getRelativeLocaleUrl } from 'astro:i18n';

interface Props {
	title?: string;
}

const { title = "Maydan â€“ Rivista sui mondi arabi, semitici e islamici" } = Astro.props;
const currentLocale = Astro.currentLocale || 'it';
const year = new Date().getFullYear();

// Helper to get localized path
const tPath = (path: string) => getRelativeLocaleUrl(currentLocale, path);

// Helper to switch language
const switchLang = (targetLang: string) => {
	const currentPath = Astro.url.pathname;
    // Remove the current locale prefix (e.g. /it/ or /en/)
	const pathWithoutLocale = currentPath.replace(`/${currentLocale}`, '') || '/';
	return getRelativeLocaleUrl(targetLang, pathWithoutLocale);
};
---

<!doctype html>
<html lang={currentLocale}>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
	</head>
	<body>

		<!-- Skip link -->
		<a class="skip-link" href="#contenuto">Vai al contenuto</a>
	  
		<!-- HEADER -->
		<header class="site-header">
			<div class="header-top-bar">
				<!-- Switch lingua -->
				<div class="lang-switch">
					<a href={switchLang('it')} class={`lang ${currentLocale === 'it' ? 'lang-active' : ''}`}>ðŸ‡®ðŸ‡¹ IT</a>
					<a href={switchLang('en')} class={`lang ${currentLocale === 'en' ? 'lang-active' : ''}`}>ðŸ‡¬ðŸ‡§ EN</a>
				</div>
			</div>

			<div class="header-main">
				<div class="site-logo">
					<a href={tPath('/')}>
						<img src="/logo.png" alt="Maydan Logo" class="logo-img" />
					</a>
				</div>
                
                <button id="menu-toggle" class="menu-toggle" aria-label="Menu">
                    <span class="hamburger-box">
                        <span class="hamburger-inner"></span>
                    </span>
                </button>

				<nav id="main-nav" class="main-nav" aria-label="Menu principale">
					<ul>
						<li><a href={tPath('/chi-siamo')}>CHI SIAMO</a></li>
						<li><a href={tPath('/call-e-linee-guida')}>CALL E LINEE GUIDA</a></li>
						<li><a href={tPath('/pubblicazioni')}>NUMERI</a></li>
						<li><a href={tPath('/chi-siamo#comitato')}>COMITATO EDITORIALE</a></li>
						<li><a href={tPath('/chi-siamo#scientifico')}>COMITATO SCIENTIFICO</a></li>
						<li><a href={tPath('/attivita')}>ATTIVITAâ€™</a></li>
						<li><a href={tPath('/contatti')}>CONTATTI</a></li>
					</ul>
				</nav>
			</div>
		</header>
        
        <script>
            const toggle = document.getElementById('menu-toggle');
            const nav = document.getElementById('main-nav');
            
            if (toggle && nav) {
                toggle.addEventListener('click', () => {
                    nav.classList.toggle('nav-open');
                    toggle.classList.toggle('is-active');
                });
            }
        </script>
	  
		<!-- CONTENUTO PRINCIPALE -->
		<main id="contenuto" class="site-main">
			<slot />
		</main>
	  
		<!-- FOOTER -->
		<footer class="site-footer">
		  <div class="footer-inner">
			<p>Editore: Antonio Pacifico, Piazza Nazionale 54, 80143, Napoli</p>
			<p>ISSN 2785-6976</p>
			<p>&copy; <span id="year">{year}</span> Maydan</p>
		  </div>
		</footer>
	  
	  </body>
</html>
